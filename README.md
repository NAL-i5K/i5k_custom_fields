# i5k Custom Fields

This module is designed to provide a number of custom fields for various content types on Tripal i5k websites.

The files to create the fields were generated by the [Tripal Fields Generator](https://github.com/tripal/fields_generator). For historical purposes, in each field directory, there is a text file that describes the values used in the Fields Generator.

Currently, the following fields are provided:
 - [x] Parent publication for gene/mRNA
   - On gene and mRNA pages, any publications tied to the originating analysis will be shown. [Origin: #315](https://github.com/isdapps/i5k-tripal/issues/315)
 - [x] Analysis Author(s)
   - A list of authors tied to the analysis. ADC equivalent: 'Author name'. [Origin: #344](https://github.com/isdapps/i5k-tripal/issues/344)
 - [x] Analysis Contact
   - A primary contact for the analysis. ADC equivalent: 'Contact name'. [Origin: #317](https://github.com/isdapps/i5k-tripal/issues/317)
 - [x] Contact Identifier
   - A published identifier (Orcid, Google Scholar, etc.) tied to a specific contact. [Origin: #345](https://github.com/isdapps/i5k-tripal/issues/345)
 - [ ] Polypeptide Annotations
   - On mRNA pages, related polypeptide annotations will be shown. Currently exists as a separate module, to be absorbed into this one at a future date. It currently does not exist on Github.
 - [ ] Gene JBrowse
   - Uses an iframe to display a JBrowse instance featuring the gene. Currently exists as a separate module, to be absorbed into this one at a futre date. It currently [lives here](https://github.com/NAL-i5K/gene_jbrowse_field). 

***

# Installation
1. Enable this module like any other Drupal module, either:
    ```shell
    drush pm-enable i5k_custom_fields
    ```
    or visit the Modules page of your Drupal site and enable from there.
2. Navigate to `admin/structure/bio_data` (In the menu: Structure > Tripal Content Types)
3. For each content type that may have new fields, perform the following:
    a. Click 'Manage Fields'
    b. At the top of the Manage Fields page, click "+ Check for new fields". Tripal will work its magic and find any fields added by this module.
    c. Click on the 'Manage Display' tab at the top.
    d. The new fields should be listed on this page. Use the UI to drag the fields to where you want them to appear in your page.

***

# Extended Field Description

### Parent publication for gene/mRNA

 - Content types affected:
   - Gene
   - mRNA
 - For any analyses linked to the gene or mRNA, a link is provided that leads to the original publication page during which the analysis was performed.
 - Label: *Genome Annotation Publication*
 - Machine name: `local__parent_analysis_pub`

### Analysis Contact and Analysis Authors

 - Content types affected:
   - Genome Annotation
   - Genome Assembly
 - Label: Analysis Contact, Analysis Authors
 - Machine name: `datacite__contributor`, `datacite__creator`
 - For analysis types, people related to the analysis have their Contact page linked to. People listed as 'Contact Analysis' are the primary contact for the analysis while 'Contact Authors' is a list of people who are otherwise associated to the analysis. A person can be included as types simultaneously for the same analysis as well as related to multiple analyses.

### Contact Identifier
 - Content types affected:
   - Contact
Utilizes a dbxref table, contact_dbxref
 - Field name: *Contact Identifier*
 - Machine name: `datacite__nameidentifier`
 - For Contact types, a field is added which display's a number of identifiers for that person such as ORCID and Google Scholar. The chado.contact_dbxref table is used to store a list of database cross references (chado.dbxref).

 ###### Loading Data
 This field does not include the ability to edit values via the UI. Data is expected to be loaded. A few required items must be in place for the field to work.
  1. At least one database entry must exist in the `chado.db` table, such as ORCID. These can be loaded via the Chado Databases page.
  2. An entry must be made in the `chado.dbxref` table which references the `chado.db` entry (via the db_id column).
  3. Finally, an entry must be made in the newly-created `chado.contact_dbxref` table which links the `chado.dbxref` entry (via the dbxref_id column) to an existing contact (via the contact_id column).
  4. Clear the cache: `drush cc all`


